<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Plastic Waste Trade Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="src/css/style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <script src="https://unpkg.com/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
</head>
<body>
    <header class="hero-section">
        <div class="hero-content">
            <div class="badge">2002-2024 â€¢ Global Trade Analysis</div>
            <h1 class="hero-title">
                The Plastic
                <span class="gradient-text">Waste Trade</span>
            </h1>
            <p class="hero-intro">
                Every year, wealthy nations ship millions of tons of plastic waste to developing countries in what researchers call "waste colonialism." When China banned imports in 2018, global emissions jumped by 4.5 million tons of CO2 as recycling rates plummeted and flows shifted to Southeast Asia. A <a href="https://eia-international.org/wp-content/uploads/2024-EIA-Dirty-Deals-Part-One.pdf" target="_blank" rel="noopener noreferrer" class="hero-link">2024 investigation by the Environmental Investigation Agency</a> reveals how this $4 billion trade is riddled with fraud, environmental crimes, and human rights violations.
            </p>
            <div class="hero-stats">
                <div class="stat">
                    <div class="stat-number">11M</div>
                    <div class="stat-label">Tons traded annually</div>
                </div>
                <div class="stat">
                    <div class="stat-number">47+</div>
                    <div class="stat-label">Countries involved</div>
                </div>
                <div class="stat">
                    <div class="stat-number">9%</div>
                    <div class="stat-label">Actually recycled</div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Timeline Connection Element - Independent of any container -->
    <div class="timeline-connection-container" id="timeline-connection-container">
        <svg class="timeline-connection-svg" id="timeline-connection-svg"></svg>
    </div>
    
    <div class="dashboard-container">
        <!-- Top Panel: Country Summary Chart -->
        <div class="dashboard-intro">
            <section class="chart-panel summary-panel">
                <div class="panel-header" style="padding: var(--space-lg) var(--space-lg) 0">
                    <h3>Major Trading Countries Over Time</h3>
                    <div class="chart-controls">
                        <button class="chart-toggle btn btn-active" data-view="exports">Exports</button>
                        <button class="chart-toggle btn" data-view="imports">Imports</button>
                        <button class="chart-toggle btn" data-view="net">Net Trade</button>
                    </div>
                </div>
                <div class="chart-content" id="country-summary-chart">
                    <!-- This will contain the year indicator that the network emerges from -->
                    <div class="year-indicator" id="chart-year-indicator">
                        <span id="chart-year-display">Chart Loading...</span>
                    </div>
                </div>
                
            </section>

            <div class="year-connection-arrow" id="year-connection-arrow">
                <div class="arrow-shaft"></div>
                <div class="arrow-head"></div>
            </div>
        </div>

        <!-- Network Group Wrapper - This sits below and connects to the year indicator -->
        <div class="network-group-wrapper" id="network-group-wrapper">
            <div class="controls-section">
                <div class='controls-top-row'>
                    <div class="controls-header">
                        <div class="current-year-display">
                            <h3 class="hero-title">2002</h3>
                        </div>
                    </div>
                    
                    <!-- Timeline Section -->
                    <div class="timeline-section">
                        <div class="timeline-wrapper">
                            <div class="timeline-header">
                                <div class="timeline-label">Timeline</div>
                                <div class="timeline-year-display" id="timeline-year-target">
                                    <span id="timeline-year-display">2002</span>
                                </div>
                            </div>
                            <div class="timeline-track">
                                <div id="year-slider">
                                    <input type="range" min="2002" max="2022" value="2002" step="1">
                                </div>
                                <div class="tick-marks"></div>
                                <div class="year-labels-track"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Main Dashboard Grid -->
                <div class="dashboard-grid">
                    <!-- Trade Flow Network -->
                    <section class="chart-panel flow-panel">
                        <div class="panel-header">
                            <h3>Trade Flow Network</h3>
                            <p class="chart-subtitle">Major bilateral trade relationships</p>
                            <p class="chart-caption">
                                Line thickness shows volume in kilograms. Hover over flows for details.
                            </p>
                        </div>
                        <div class="chart-content" id="sankey-chart"></div>
                    </section>

                    <!-- Global Map -->
                    <section class="chart-panel map-panel">
                        <div class="panel-header">
                            <h3>Global Trade Network</h3>
                            <p class="chart-subtitle">Countries colored by net trade balance</p>
                            <p class="chart-caption">
                                Click countries for details. Arrows show major trade flows for the selected year.
                            </p>
                        </div>
                        <div class="chart-content">
                            <div class="map-legend" id="map-legend"></div>
                            <div id="map-container"></div>
                        </div>
                    </section>
                </div>

                
            </div>
            
        </div>

        <!-- Modal Structure -->
        <div id="chart-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-title">Chart Details</h3>
                    <button class="modal-close btn-close">&times;</button>
                </div>
                <div class="modal-body" id="modal-chart-container">
                    <!-- Chart will be cloned here -->
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>Data: UN Comtrade Database (HS Code 3915) | Created with D3.js | <span id="current-year"></span></p>
    </footer>

    <!-- JS Components -->
    <script src="src/js/components/timelineConnector.js"></script>
    <script src="src/js/components/countrysummary.js"></script>
    <script src="src/js/components/map.js"></script>
    <script src="src/js/components/slider.js"></script>
    <script src="src/js/components/flowArrows.js"></script>
    <script src="src/js/components/sankey.js"></script>
    <script src="src/js/components/filters.js"></script>
    <script src="src/js/components/countryDetails.js"></script>
    <script src="src/js/components/modals.js"></script>
    <script src="src/js/components/countryLabels.js"></script>
    <script src="src/js/main.js"></script>
</body>
</html>